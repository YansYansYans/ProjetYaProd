<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Retrouvez toute les musiques de l'artiste YaProd.">

    <title>YaProd - Musician</title>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
        integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="assets/scss/styles.css">
    <link href="img/logo.ico" rel="shortcut icon" />
    <link rel="stylesheet" href="https://cdn.plyr.io/3.5.6/plyr.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5media/1.1.8/html5media.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plyr/3.5.6/plyr.min.js"></script>

</head>

<body class="body-music">

    <header>
        <nav>
            <ul>
                <li>
                    <a href="index.html">HOME</a>
                </li>
                <li>
                    <a href="music.html">MUSIC</a>
                </li>
                <li>
                    <a href="contact.html">CONTACT</a>
                </li>
                <li>
                    <a href="sites.html">SITES</a>
                </li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <div class="column add-bottom">
            <div id="mainwrap">
                <div class="title-all-music">
                    <h2>
                        ALL MUSIC
                    </h2>
                </div>
                <div id="plwrap">
                    <ul id="plList"></ul>
                </div>
            </div>
        </div>
    </main>

    <div id="audiowrap">
        <div id="audio0">
            <audio id="audio1" preload controls>Your browser does not support HTML5 Audio! ðŸ˜¢</audio>
        </div>
    </div>

    <div class="header-device header-device-music">
        <a href="index.html">
            <i class="fas fa-home"></i>
            <h6>HOME</h6>
        </a>
        <a href="music.html">
            <i class="fas fa-compact-disc"></i>
            <h6>MUSIC</h6>
        </a>
        <a href="contact.html">
            <i class="fas fa-paper-plane"></i>
            <h6>CONTACT</h6>
        </a>
        <a href="sites">
            <i class="fas fa-plus-circle"></i>
            <h6>SITES</h6>
        </a>
    </div>

    <script>
        jQuery(function ($) {
            'use strict'
            var supportsAudio = !!document.createElement('audio').canPlayType;
            if (supportsAudio) {
                var player = new Plyr('#audio1', {
                    controls: [
                        'restart',
                        'play',
                        'progress',
                        'current-time',
                        'duration',
                        'mute',
                        'volume',
                        'download'
                    ]
                });
                // initialize playlist and controls
                var index = 0,
                    playing = false,
                    mediaPath = 'https://archive.org/download/yaprod/',
                    extension = '',
                    tracks = [{
                        "track": 1,
                        "name": "PLAYA - by YaProd",
                        "duration": "3:46",
                        "file": "PLAYA"
                    }, {
                        "track": 2,
                        "name": "TIMBALE - by YaProd",
                        "duration": "5:50",
                        "file": "TIMBALE"
                    }, {
                        "track": 3,
                        "name": "SALSA - by YaProd",
                        "duration": "3:10",
                        "file": "SALSA"
                    }, {
                        "track": 4,
                        "name": "PROJET D - by YaProd (Remastering DXNNY)",
                        "duration": "3:22",
                        "file": "PROJET D"
                    }, {
                        "track": 5,
                        "name": "THIS IS MY STORY - by YaProd",
                        "duration": "3:06",
                        "file": "THIS IS MY STORY"
                    }, {
                        "track": 6,
                        "name": "VALLEY - by YaProd",
                        "duration": "3:12",
                        "file": "VALLEY"
                    }, {
                        "track": 7,
                        "name": "COMMENCEMENT - YaProd",
                        "duration": "3:31",
                        "file": "COMMENCEMENT"
                    }],
                    buildPlaylist = $.each(tracks, function (key, value) {
                        var trackNumber = value.track,
                            trackName = value.name,
                            trackDuration = value.duration;
                        if (trackNumber.toString().length === 1) {
                            trackNumber = '0' + trackNumber;
                        }
                        $('#plList').append('<li> \
                      <div class="plItem"> \
                          <span class="plNum">' + trackNumber + '.</span> \
                          <span class="plTitle">' + trackName + '</span> \
                          <span class="plLength">' + trackDuration + '</span> \
                      </div> \
                  </li>');
                    }),
                    trackCount = tracks.length,
                    npAction = $('#npAction'),
                    npTitle = $('#npTitle'),
                    audio = $('#audio1').on('play', function () {
                        playing = true;
                        npAction.text('Now Playing...');
                    }).on('pause', function () {
                        playing = false;
                        npAction.text('Paused...');
                    }).on('ended', function () {
                        npAction.text('Paused...');
                        if ((index + 1) < trackCount) {
                            index++;
                            loadTrack(index);
                            audio.play();
                        } else {
                            audio.pause();
                            index = 0;
                            loadTrack(index);
                        }
                    }).get(0),
                    btnPrev = $('#btnPrev').on('click', function () {
                        if ((index - 1) > -1) {
                            index--;
                            loadTrack(index);
                            if (playing) {
                                audio.play();
                            }
                        } else {
                            audio.pause();
                            index = 0;
                            loadTrack(index);
                        }
                    }),
                    btnNext = $('#btnNext').on('click', function () {
                        if ((index + 1) < trackCount) {
                            index++;
                            loadTrack(index);
                            if (playing) {
                                audio.play();
                            }
                        } else {
                            audio.pause();
                            index = 0;
                            loadTrack(index);
                        }
                    }),
                    li = $('#plList li').on('click', function () {
                        var id = parseInt($(this).index());
                        if (id !== index) {
                            playTrack(id);
                        }
                    }),
                    loadTrack = function (id) {
                        $('.plSel').removeClass('plSel');
                        $('#plList li:eq(' + id + ')').addClass('plSel');
                        npTitle.text(tracks[id].name);
                        index = id;
                        audio.src = mediaPath + tracks[id].file + extension;
                        updateDownload(id, audio.src);
                    },
                    updateDownload = function (id, source) {
                        player.on('loadedmetadata', function () {
                            $('a[data-plyr="download"]').attr('href', source);
                        });
                    },
                    playTrack = function (id) {
                        loadTrack(id);
                        audio.play();
                    };
                extension = audio.canPlayType('audio/mpeg') ? '.mp3' : audio.canPlayType('audio/ogg') ? '.ogg' :
                    '';
                loadTrack(index);
            } else {
                // no audio support
                $('.column').addClass('hidden');
                var noSupport = $('#audio1').text();
                $('.container').append('<p class="no-support">' + noSupport + '</p>');
            }
        });
    </script>
</body>

</html>